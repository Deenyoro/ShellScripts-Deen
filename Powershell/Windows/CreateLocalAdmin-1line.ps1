$createLocalAdmin = Read-Host -Prompt "Do you want to create a local admin account? (Y/N)"; if ($createLocalAdmin -eq 'Y') {$localAdminUsername = Read-Host -Prompt "Enter the new local admin username (Default: Admin)"; if ($localAdminUsername -eq "") {$localAdminUsername = "Admin"}; $input = Read-Host -Prompt "Enter password"; if ($input -eq "") {Write-Host "No password entered, using default password: Pass1Word"; $localAdminPassword = ConvertTo-SecureString "Pass1Word" -AsPlainText -Force} else {$localAdminPassword = $input | ConvertTo-SecureString -AsPlainText -Force}; Write-Host "Creating local admin account..."; $localAdminAccount = New-LocalUser -Name $localAdminUsername -Password $localAdminPassword -FullName "Local Administrator" -Description "Local admin account" -UserMayNotChangePassword -PasswordNeverExpires; Add-LocalGroupMember -Group "Administrators" -Member $localAdminAccount.Name; Write-Host "Local admin account created."; $enableRDP = Read-Host -Prompt "Do you want to enable RDP for this admin account? (Y/N)"; if ($enableRDP -eq 'Y') {Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -name "fDenyTSConnections" -Value 0; Enable-NetFirewallRule -DisplayGroup "Remote Desktop"; Write-Host "RDP has been enabled for the account: $localAdminUsername"}}
